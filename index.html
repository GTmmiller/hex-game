<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>Hexagon Fun</title>
  <meta name="description" content="My continued study into hexagons">
  <meta name="author" content="Steven Miller">

  <link rel="stylesheet" href="css/styles.css?v=1.0">

</head>

<body>
  <script src="js/fabric.js"></script>
  <canvas id="test" width="900" height="900"></canvas>
  <script>
    let canvas = new fabric.Canvas('test')
    console.log(canvas.getWidth())
    console.log(canvas.getHeight())

    let hexagonPoints = [
      { x: 50, y: 25 },
      { x: 100, y: 0 },
      { x: 150, y: 25 },
      { x: 150, y: 75 },
      { x: 100, y: 100 },
      { x: 50, y: 75},
      { x: 50, y: 25}
    ]

    gamestate = {
      turn: 0,
      player: 1,
      colors: { 
        1: 'red',
        2: 'blue'
      },
      // p by q
      usedTiles: {
      }
    }
    
    let Hexagon = fabric.util.createClass(fabric.Polygon, {
      initialize: function (options) {
        // Use the size to create the initial coordinates
        // for a regular hexagon in the pointed top configuration
        this.size = options.size || 0
        this.width = Math.sqrt(3) * this.size
        this.height = 2 * this.size
        let points = [
          // top point then clockwise
          { x: this.width * 0.5, y: 0 },
          { x: this.width, y: this.height * 0.25 },
          { x: this.width, y: this.height * 0.75 },
          { x: this.width * 0.5, y: this.height },
          { x: 0, y: this.height * 0.75 },
          { x: 0, y: this.height * 0.25 }
        ]
        this.callSuper('initialize', points, options) 
      }
    })
    canvas.add(new Hexagon({top: 100, left: 100, size: 50, fill: 'white'}))

    /*
    let HexTile = fabric.util.createClass(fabric.Polyline, {
      initialize: function(q, r, options, gamestate) {
        this.callSuper('initialize', hexagonPoints, options);
        // set up the default options for hexagon tiles
        let scaleX = options.scaleX || 1
        let scaleY = options.scaleY || 1
        this.left = options.left || (100 + (100 * q) + (r * 50)) * scaleX
        options.top = options.top || (100 + (75 * r)) * scaleY
        options.stroke = options.stroke || 'black'
        options.fill = options.fill || 'white'
        options.scaleX = options.scaleX || scale
        options.scaleY = options.scaleY || scale
        // Know what your q and r are
        this.q = q
        this.r = r 
        this.gamestate = gamestate
      }
    }) */

    let createHexagon = function(q, r, scale) {
      const left = 100 + (100 * q) + (r * 50)
      const top = 100 + (75 * r)
      let poly = new fabric.Polyline(hexagonPoints, {
        stroke: 'black',
        fill: 'white',
        left: left * scale,
        top: top * scale,
        originX: 'center',
        originY: 'center',
        scaleX: scale,
        scaleY: scale,
      })
      poly.on('mousedown', function(e) {
        e.target.set({fill: 'red'})
      })

      return poly
    } 

    
    // q=0, r=0
    let polyCenter = new fabric.Polyline(hexagonPoints, {
      stroke: 'black',
      fill: 'white',
      left: canvas.getWidth() / 2,
      top: canvas.getHeight() / 2,
      originX: 'center',
      originY: 'center'
    })

    // q=1, r=0
    let polyRight = new fabric.Polyline(hexagonPoints, {
      stroke: 'black',
      fill: 'white',
      left: canvas.getWidth() / 2 + 100,
      top: canvas.getHeight() / 2,
      originX: 'center',
      originY: 'center'
    })

    // q=1, r=-1
    let polyTopRight = new fabric.Polyline(hexagonPoints, {
      stroke: 'black',
      fill: 'white',
      left: canvas.getWidth() / 2 + 50,
      top: canvas.getHeight() / 2 - 75,
      originX: 'center',
      originY: 'center'
    })

    // q=0 r=1
    let polyBottomRight = new fabric.Polyline(hexagonPoints, {
      stroke: 'black',
      fill: 'white',
      left: canvas.getWidth() / 2 + 50,
      top: canvas.getHeight() / 2 + 75,
      originX: 'center',
      originY: 'center'
    })

    // // createHexagon(0,0), createHexagon(0, 1), createHexagon(1,0), 
    // for (let i = 0; i < 11; i++) {
    //   for(let j = 0; j < 11; j++) {
    //     canvas.add(new HexTile(i, j, 0.5))
    //   }
    // }
    canvas.add(new fabric.Rect({width: 100, height: 100}))
    // canvas.add(polyCenter, polyRight, polyTopRight, polyBottomRight)
    // canvas.add(createHexagon(0,0, 0.5), createHexagon(0, 1, 0.5), createHexagon (1, 0, 0.5))
  </script>
</body>
</html>